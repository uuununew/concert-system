# 콘서트 예약 서비스 - 요구사항 분석

## ✨ 서비스 개요
- 콘서트 예약 서비스는 유저가 대기열 시스템을 거쳐 공정하게 좌석을 예약하고 충전된 잔액을 이용해 결제하는 구조로 설계됨 
- 좌석은 단순히 예약만으로 확정되지 않고 임시로 점유된 상태로 일정 시간이 지나면 자동으로 해제되어 다른 사용자도 다시 접근 가능

---

## 📌 핵심 기능 요약
- 유저 토큰 발급 API
- 예약 가능 날짜 및 좌석 조회 API
- 좌석 예약 요청 API
- 잔액 충전 / 조회 API
- 결제 API

---

## 📥 상세 요구사항

### 1️⃣ 유저 대기열 토큰 기능
- 서비스를 이용하려면 먼저 토큰을 발급받아야 함
- 토큰에는 유저의 UUID뿐만 아니라 대기열 관련 정보(대기 순번 또는 잔여 대기 시간 등)가 포함됨
- 이 토큰은 이후 모든 요청에서 유효성을 검사하는 데 사용되고 대기열을 통과한 사용자만 서비스 기능을 이용할 수 있음
- 기본적으로 유저는 폴링 방식으로 대기 상태를 확인

### 2️⃣ 예약 가능 날짜 및 좌석 조회 API
- 유저는 예약 가능한 날짜 리스트를 조회
- 특정 날짜를 선택하면 해당 날짜의 예약 가능한 좌석 목록을 확인
- 좌석은 1번부터 50번까지 번호로 관리됨

### 3️⃣ 좌석 예약 요청 API
- 유저가 특정 날짜와 좌석 번호를 입력해 좌석을 예약 요청
- 이때 좌석은 즉시 임시 배정 상태로 전환되며 해당 좌석은 5분간 다른 유저가 접근할 수 없음
- 임시 배정 상태는 유저가 결제를 완료하지 않을 경우 자동으로 해제됨
- 점유 중인 좌석은 동시에 다른 유저가 예약 시도할 수 없음

**정책**
- 임시 배정 시간: 5분 


### 4️⃣ 잔액 충전 / 조회 API
- 유저는 별도의 API를 통해 잔액을 충전할 수 있으며 현재 보유 중인 잔액도 조회 가능
- 결제에는 반드시 사전에 충전된 잔액이 사용
- 해당 기능에는 토큰 필요 x


### 5️⃣ 결제 API
- 임시 배정된 좌석을 결제 처리하며 결제가 완료되면 해당 좌석의 소유권이 유저에게 완전히 배정됨
- 이 시점에 대기열 토큰도 만료 처리되어 더 이상 다른 기능을 이용할 수 없음
- 결제 내역은 별도로 저장..

---

## 🧠 구현 시 고려사항
- **대기열 정렬**: 유저 간 요청 순서를 정확하게 반영하여 대기열이 운영되도록 구현
- **동시성 제어**: 여러 사용자가 동시에 좌석을 요청했을 때 같은 좌석이 중복 배정되지 않도록 처리

---

## 🧪 테스트 요구사항
- 모든 기능(API)에 대해 단위 테스트를 작성해야 하며, 최소 1개 이상의 테스트 케이스가 필요합니다.
- 특히 좌석 임시 배정과 해제, 결제 처리 및 대기열 통과 여부 등은 반드시 테스트 코드로 검증되어야 합니다.

